# 로컬 Excel 파일 데이터베이스 API 서버

Node.js와 Express를 사용하여 로컬 파일 시스템의 Excel 파일을 데이터베이스처럼 다루는 API 서버입니다. 서버 내의 `data` 디렉토리에 있는 Excel 파일을 읽고, 생성하고, 수정할 수 있습니다.

## 시작하기

### 필요 사항

- [Node.js](https://nodejs.org/) (v14 이상 권장)

### 설치 및 실행

1. 저장소를 클론하거나 코드를 다운로드합니다.
2. 프로젝트 루트 디렉토리에서 의존성을 설치합니다.

    ```bash
    npm install
    ```

3. 서버를 시작합니다.

    ```bash
    node index.js
    ```

4. 서버는 `http://localhost:3000` 에서 실행됩니다.
5. 모든 Excel 파일은 프로젝트 루트에 자동으로 생성되는 `data/` 디렉토리 내에서 관리됩니다.

## API 엔드포인트

모든 요청의 `Content-Type`은 `application/json` 입니다.

### 1. Excel 파일 읽기

`data` 디렉토리에서 지정된 Excel 파일을 읽어 그 내용을 JSON 배열로 반환합니다. 첫 번째 행을 데이터의 키(헤더)로 사용합니다.

- **URL**: `/read`
- **Method**: `POST`
- **Request Body**:

    ```json
    {
      "fileName": "employees.xlsx"
    }
    ```

- **성공 응답**:
  - **Code**: `200 OK`
  - **Content**: `[{ "Name": "John Doe", "Age": "30" }, ...]`
- **`curl` 예시**:

    ```bash
    curl -X POST -H "Content-Type: application/json" \
    -d '{"fileName": "employees.xlsx"}' \
    http://localhost:3000/read
    ```

### 2. Excel 파일 생성

JSON 데이터를 받아 `data` 디렉토리에 새로운 Excel 파일을 생성합니다.

- **URL**: `/create`
- **Method**: `POST`
- **Request Body**:

    ```json
    {
      "fileName": "products.xlsx",
      "data": [
        { "ID": 1, "Product": "Laptop", "Price": 1200 },
        { "ID": 2, "Product": "Mouse", "Price": 25 }
      ],
      "headers": ["ID", "Product", "Price"]
    }
    ```

  - `fileName` (String): 생성할 파일의 이름. 이미 동일한 이름의 파일이 존재할 경우, 덮어쓰지 않고 오류를 반환합니다.
  - `data` (Array<Object>): 파일에 쓸 데이터.
  - `headers` (Array<String>, Optional): 헤더 순서를 지정합니다. 지정하지 않으면 `data` 객체의 키 순서를 따릅니다.

- **성공 응답**:
  - **Code**: `201 CREATED`
  - **Content**: `{ "message": "파일이 성공적으로 생성되었습니다: products.xlsx" }`
- **`curl` 예시**:

    ```bash
    curl -X POST -H "Content-Type: application/json" \
    -d '{"fileName": "products.xlsx", "data": [{"ID": 1, "Product": "Laptop"}, {"ID": 2, "Product": "Mouse"}], "headers": ["ID", "Product"]}' \
    http://localhost:3000/create
    ```

### 3. 기존 Excel 파일 수정

`data` 디렉토리에 있는 기존 Excel 파일의 특정 위치에 데이터를 추가하거나 덮어씁니다.

- **URL**: `/modify`
- **Method**: `POST`
- **Request Body**:

    ```json
    {
      "fileName": "inventory.xlsx",
      "data": [
        ["Region", "Q1 Sales"],
        ["North", 5000],
        ["South", 8000]
      ],
      "sheet": "SalesData",
      "origin": "C1"
    }
    ```

  - `fileName` (String): 수정할 파일의 이름.
  - `data` (Array<Array>): 파일에 쓸 2차원 배열 데이터. `sheet_add_aoa` 함수를 사용하므로 객체 배열이 아닌 **배열의 배열** 형식이어야 합니다.
  - `sheet` (String, Optional): 데이터를 쓸 시트의 이름. 없으면 첫 번째 시트가 사용되며, 시트가 존재하지 않으면 새로 생성됩니다.
  - `origin` (String, Optional): 데이터 쓰기를 시작할 셀 주소(A1 표기법). 기본값: `"A1"`.

- **성공 응답**:
  - **Code**: `200 OK`
  - **Content**: `{ "message": "파일이 성공적으로 수정되었습니다: inventory.xlsx" }`
- **`curl` 예시**:

    ```bash
    # inventory.xlsx 파일의 SalesData 시트 C1 셀부터 데이터 쓰기
    curl -X POST -H "Content-Type: application/json" \
    -d '{"fileName": "inventory.xlsx", "data": [["Region", "Q1 Sales"], ["North", 5000]], "sheet": "SalesData", "origin": "C1"}' \
    http://localhost:3000/modify
    ```
