# Excel 파일 IO API 서버

Node.js와 Express를 사용하여 Excel 파일을 다루는 간단한 API 서버입니다. 이 서버를 통해 Excel 파일을 JSON으로 변환하거나, JSON 데이터를 Excel 파일로 생성 및 다운로드하고, 기존 Excel 파일을 수정할 수 있습니다.

## 시작하기

### 필요 사항

- [Node.js](https://nodejs.org/) (v14 이상 권장)

### 설치 및 실행

1. 저장소를 클론하거나 코드를 다운로드합니다.
2. 프로젝트 루트 디렉토리에서 의존성을 설치합니다.

    ```bash
    npm install
    ```

3. 서버를 시작합니다.

    ```bash
    node index.js
    ```

4. 서버는 `http://localhost:3000` 에서 실행됩니다.

## API 엔드포인트

### 1. Excel 파일 업로드 및 JSON 변환

첫 행을 헤더로 사용하여 Excel 시트의 데이터를 JSON 레코드 배열로 변환합니다.

- **URL**: `/upload`
- **Method**: `POST`
- **Content-Type**: `multipart/form-data`
- **Parameters**:
  - `excel` (File): 업로드할 Excel 파일.

- **성공 응답**:
  - **Code**: `200 OK`
  - **Content**: `[{ "Header1": "value1", "Header2": "value2" }, ...]`

- **`curl` 예시**:

    ```bash
    curl -X POST -F "excel=@/path/to/your/file.xlsx" http://localhost:3000/upload
    ```

### 2. JSON 데이터를 Excel 파일로 생성 및 다운로드

JSON 데이터를 Excel 파일로 변환하여 다운로드합니다. 커스텀 헤더를 지정하여 열의 순서를 제어할 수 있습니다.

- **URL**: `/download`
- **Method**: `POST`
- **Content-Type**: `application/json`
- **Query Parameters**:
  - `fileName` (String, Optional): 다운로드될 파일의 이름. 기본값: `output.xlsx`.
- **Request Body**:

    ```json
    {
      "data": [
        { "Name": "John Doe", "Age": 30, "City": "New York" },
        { "Name": "Jane Smith", "Age": 25, "City": "London" }
      ],
      "headers": ["Name", "Age", "City"]
    }
    ```

  - `data` (Array<Object>): Excel로 변환할 데이터.
  - `headers` (Array<String>, Optional): Excel 시트의 헤더(첫 행)로 사용할 문자열 배열. 지정하면 해당 순서대로 열이 생성됩니다. 지정하지 않으면 `data` 객체의 키 순서를 따릅니다.

- **성공 응답**:
  - **Code**: `200 OK`
  - **Content**: 생성된 Excel 파일 데이터.

- **`curl` 예시**:

    ```bash
    # 기본 사용법
    curl -X POST -H "Content-Type: application/json" \
    -d '{"data": [{"Name": "John Doe", "Age": 30}, {"Name": "Jane Smith", "Age": 25}]}' \
    --output sample.xlsx \
    http://localhost:3000/download

    # 헤더 순서 지정
    curl -X POST -H "Content-Type: application/json" \
    -d '{"data": [{"City": "New York", "Name": "John Doe", "Age": 30}], "headers": ["Name", "Age", "City"]}' \
    --output ordered.xlsx \
    "http://localhost:3000/download?fileName=ordered.xlsx"
    ```

### 3. 기존 Excel 파일 수정

기존 Excel 파일의 특정 시트, 특정 셀 범위에 데이터를 덮어쓰거나 추가합니다.

- **URL**: `/modify`
- **Method**: `POST`
- **Content-Type**: `multipart/form-data`
- **Query Parameters**:
  - `fileName` (String, Optional): 다운로드될 수정된 파일의 이름. 기본값: `modified.xlsx`.
- **Form Data Parameters**:
  - `excel` (File): 수정할 원본 Excel 파일.
  - `data` (String): JSON으로 직렬화된 2차원 배열 데이터. 예: `'[["Header"], ["Value"]]'`.
  - `sheet` (String, Optional): 데이터를 쓸 시트의 이름. 지정하지 않으면 첫 번째 시트를 사용합니다. 해당 이름의 시트가 없으면 새로 생성됩니다.
  - `origin` (String, Optional): 데이터 쓰기를 시작할 셀 주소 (A1 표기법). 기본값: `"A1"`.

- **성공 응답**:
  - **Code**: `200 OK`
  - **Content**: 수정된 Excel 파일 데이터.

- **`curl` 예시**:

    ```bash
    # report.xlsx 파일의 Sales 시트 E1 셀부터 데이터 쓰기
    curl -X POST \
    -F "excel=@/path/to/your/report.xlsx" \
    -F "data=[[\"Status\"], [\"Completed\"]]" \
    -F "sheet=Sales" \
    -F "origin=E1" \
    --output report_modified.xlsx \
    "http://localhost:3000/modify?fileName=report_final.xlsx"
    ```
